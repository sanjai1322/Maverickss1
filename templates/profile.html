{% extends "base.html" %}

{% block title %}Launch Your Journey - Mavericks{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mb-0">
                    <i class="fas fa-rocket me-2"></i>
                    Launch Your Maverick Journey
                </h3>
            </div>
            <div class="card-body">
                <p class="text-muted mb-4">
                    Upload your resume and unleash our revolutionary AI to discover your hidden potential. 
                    The more comprehensive your resume, the deeper our intelligent analysis will be.
                </p>
                
                <form method="POST" action="{{ url_for('profile') }}" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="username" class="form-label">
                            <i class="fas fa-user me-1"></i>
                            Username *
                        </label>
                        <input type="text" class="form-control" id="username" name="username" 
                               placeholder="Enter your username" required>
                        <div class="form-text">Choose a unique username for your profile.</div>
                    </div>
                    
                    <div class="mb-4">
                        <label for="resume_file" class="form-label">
                            <i class="fas fa-file-upload me-1"></i>
                            Resume File *
                        </label>
                        <input type="file" class="form-control" id="resume_file" name="resume_file" 
                               accept=".pdf,.doc,.docx,.txt" required>
                        <div class="form-text">
                            Upload your resume as a PDF, Word document, or text file. 
                            Our system will extract and analyze the content to identify your technical skills.
                        </div>
                        <div id="file-preview" class="mt-2" style="display: none;">
                            <div class="alert alert-info">
                                <i class="fas fa-file me-2"></i>
                                <span id="file-name"></span>
                                <span id="file-size" class="text-muted ms-2"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{{ url_for('index') }}" class="btn btn-outline-secondary me-md-2">
                            <i class="fas fa-arrow-left me-1"></i>
                            Back to Home
                        </a>
                        <button type="submit" class="btn btn-maverick" id="submit-btn">
                            <i class="fas fa-rocket me-1"></i>
                            Launch Analysis
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-body">
                <h6 class="card-title">
                    <i class="fas fa-info-circle me-2"></i>
                    What happens next?
                </h6>
                <ul class="list-unstyled mb-0">
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>
                        Our system will extract key technical skills from your uploaded resume
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>
                        You'll be redirected to take a comprehensive assessment
                    </li>
                    <li class="mb-0">
                        <i class="fas fa-check text-success me-2"></i>
                        Receive personalized feedback and scoring
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// File upload handling
document.getElementById('resume_file').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const preview = document.getElementById('file-preview');
    const fileName = document.getElementById('file-name');
    const fileSize = document.getElementById('file-size');
    const submitBtn = document.getElementById('submit-btn');
    
    if (file) {
        // Show file preview
        fileName.textContent = file.name;
        fileSize.textContent = `(${(file.size / 1024 / 1024).toFixed(2)} MB)`;
        preview.style.display = 'block';
        
        // Validate file type
        const allowedTypes = ['application/pdf', 'application/msword', 
                            'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                            'text/plain'];
        const allowedExtensions = ['.pdf', '.doc', '.docx', '.txt'];
        
        const isValidType = allowedTypes.includes(file.type) || 
                           allowedExtensions.some(ext => file.name.toLowerCase().endsWith(ext));
        
        if (!isValidType) {
            preview.className = 'mt-2';
            preview.innerHTML = `
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    Invalid file type. Please upload a PDF, Word document, or text file.
                </div>
            `;
            submitBtn.disabled = true;
            return;
        }
        
        // Check file size (max 10MB)
        if (file.size > 10 * 1024 * 1024) {
            preview.className = 'mt-2';
            preview.innerHTML = `
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    File size is large (${(file.size / 1024 / 1024).toFixed(2)} MB). Processing may take longer.
                </div>
            `;
        }
        
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<i class="fas fa-upload me-1"></i>Upload & Analyze Resume';
    } else {
        preview.style.display = 'none';
        submitBtn.disabled = true;
    }
});

// Form submission handling
document.querySelector('form').addEventListener('submit', function(e) {
    const submitBtn = document.getElementById('submit-btn');
    const file = document.getElementById('resume_file').files[0];
    
    if (!file) {
        e.preventDefault();
        alert('Please select a resume file to upload.');
        return;
    }
    
    // Show loading state
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Processing Resume...';
});
</script>
{% endblock %}
